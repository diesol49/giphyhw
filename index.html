<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Giphy Buttons</title>
    <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>
    <div class="container">
        <div id="buttons"></div>
        <!-- add the buttons -->
        <form id="form">
            <label for="user-input"> Search Wrestler!!</label>
            <input type="text" id="empty-field"><br>

            <input id="add-gif" type="submit" value="Submit!">
        </form>
        <div id="gifs-appear-here"></div>
    </div>
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

    
    var wrestler = $().attr("user-input");
        
    // URL for Giphy API
    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
    wrestler + "&api_key=D2gtsqwcjJka3b01W31xPwv2iZUzCRZq&q=WWE&limit=15&offset=0&rating=PG&lang=en";

    $.ajax({
        url: queryURL,
        method: "GET"
    }).then(function(response) {
        console.log(queryURL);
        console.log(response);

        var results = response.data;
        for(var i = 0; i < results.length; i++) {
            var wrestlerDiv = $("<div>");

            var p = $("<p>").text("Rating: " + results[i].rating);
            var wrestlerImage = $("<img>");
            wrestlerImage.attr("src", results[i].images.fixed_height.url);

            wrestlerDiv.append(p);
            wrestlerDiv.append(wrestlerImage);

            $("#gifs-appear-here").prepend(wrestlerDiv);
        }

    });
    //This is where the buttons render
    function renderButtons() {
        // to prevent having repeated buttons
        $("#buttons").empty();
        for (var i = 0; i < results.length; i++){
            $("#buttons").append("<button>" + gif[i] + "</button>");
        }
        // create the gifs that are loaded
        var gif = $("<button>");

        gif.addClass("WWE");
        gif.attr("data-name", results[i]);
        gif.text(wrestler);

        $("#buttons").append(gif);
    }

    // function to track butotn click
    $("#add-gif").on("click", function(event) {
        event.preventDefault();
        var gifs = $("user-input").val();
        $("#buttons").append("<button>" + wrestler + "</button>");
        return false;
        renderButtons();
    });
    
    </script>
</body>
</html>